@model LabourTimeTable.Models.LabourComplaintDetailDTO

@{
	ViewBag.Title = "Complaint";
	Layout = "~/Views/Shared/_Layout.cshtml";
}

@{
	var grid = new WebGrid(Model._TimesheetComGridPostDTO, canPage: true, rowsPerPage: 5, selectionFieldName: "selectedRow", ajaxUpdateContainerId: "grid", ajaxUpdateCallback: "callBack");
	grid.Pager(WebGridPagerModes.All);
}


<style>
	.icheckbox_square-red.checked.disabled {
		background-color: red !important;
	}
</style>

<div class="page-container">
	<div class="clearfix">
		<div class="btn-group btn-group btn-group-justified">
			<a href="~/Home/Detail" class="btn btn-default">Project</a>
			<a href="~/Complaint/Complaint" class="btn btn-default active" style="border-bottom: 4px solid #36c6d3; position: relative;" data-toggle="tab"><b>Complain</b> </a>
			<a href="~/Others/Index" class="btn btn-default">Others </a>
		</div>
	</div>
	<div class="page-content-wrapper">
		<div class="page-content">
			<h1 class="page-title">Complain
			   
				<small>Manage Complain Attendance</small>
			</h1>
			<div class="page-bar">
				<ul class="page-breadcrumb">
					<li>
						<a href="javascript:;"></a>
					</li>
					<li>
						<span>@DateTime.UtcNow.ToLongDateString()</span>
					</li>
				</ul>
			</div>

			<div class="portlet light bordered">
				<div class="portlet-title">
					<div class="caption">
						<i class="icon-social-dribbble font-red"></i>
						<span class="caption-subject font-red bold uppercase">Manage Complain Attendance</span>
					</div>
				</div>
				@if (ViewBag.Error != null)
				{
					<div class="alert alert-danger display-hide" style="display: block;">
						<button class="close" data-close="alert"></button>
						<span>@ViewBag.Error </span>
					</div>
				}
				<div class="well">
					<!-- BEGIN FORM-->
					<form method="post" id="form" class="form-horizontal">
						<div class="form-body">
							<div class="form-group">
								<label class="col-md-3 control-label">Complain No</label>
								<div class="col-md-4">
									<input type="text" name="txtComplainNo" id="txtComplainNo" autocomplete="off" disabled="disabled" placeholder="Complain No" class="form-control autocomplete-input">
								</div>
							</div>
							<div class="form-group">
								<label class="col-md-3 control-label">Job No (Contract Maintenance No)</label>
								<div class="col-md-4">
									<input type="text" name="txtJobNo" id="txtJobNo" autocomplete="off" disabled="disabled" placeholder="Job No" class="form-control autocomplete-input">
								</div>
							</div>
							<div class="form-group">
								<label class="col-md-3 control-label">Customer</label>
								<div class="col-md-4">
									<input type="text" name="txtCustomer" id="txtCustomer" autocomplete="off" disabled="disabled" placeholder="Customer" class="form-control autocomplete-input">
								</div>
							</div>
							<div class="form-group">
								<label class="col-md-3 control-label">Complain Subject</label>
								<div class="col-md-4">
									<input type="text" name="txtComplainName" id="txtComplainName" autocomplete="off" disabled="disabled" placeholder="Complain Name" class="form-control autocomplete-input">
								</div>
							</div>
							<div class="form-group">
								<label class="col-md-3 control-label">Description</label>
								<div class="col-md-4">
									<textarea rows="4" cols="50" class="form-control" style="resize: none;" id="txtDescription" name="txtDescription" placeholder="Description"></textarea>
								</div>
							</div>
							<div class="form-group">
								<label class="col-md-3 control-label">Complain Type</label>
								<div class="col-md-4">
									<input type="text" name="txtComplainType" id="txtComplainType" autocomplete="off" disabled="disabled" placeholder="Complain Type" class="form-control autocomplete-input">
								</div>
							</div>

							<div class="form-group">
								<label class="col-md-3 control-label">Contact Person</label>
								<div class="col-md-4">
									<input type="text" name="txtContactPerson" id="txtContactPerson" autocomplete="off" disabled="disabled" placeholder="Complain Name" class="form-control autocomplete-input">
								</div>
							</div>

							<div class="form-group">
								<label class="col-md-3 control-label">Phone No</label>
								<div class="col-md-4">
									<input type="text" name="txtPhoneNo" id="txtPhoneNo" autocomplete="off" disabled="disabled" placeholder="Phone No" class="form-control">
								</div>
							</div>

							<div class="form-group">
								<label class="col-md-3 control-label">Complain Date</label>
								<div class="col-md-4">
									<input type="text" name="txtComplainDate" id="txtComplainDate" autocomplete="off" disabled="disabled" placeholder="Complain Name" class="form-control autocomplete-input">
								</div>
							</div>
							<div class="form-group">
								<label class="col-md-3 control-label">Priority</label>
								<div class="col-md-4 icheck-inline">
									<label>
										<input type="checkbox" id="chkHigh" name="chkHigh" class="icheck" disabled="disabled" data-checkbox="icheckbox_square-red">
										High
									</label>
									<label>
										<input type="checkbox" id="chkNormal" name="chkNormal" class="icheck" disabled="disabled" data-checkbox="icheckbox_square-red">
										Normal
									</label>
								</div>
							</div>

							<div class="portlet-body">
								<div class="panel-group accordion" id="accordion3">
									<div class="panel panel-default">
										<div class="panel-heading">
											<h4 class="panel-title" style="background-color: #e96864;">
												<a class="accordion-toggle accordion-toggle-styled" data-toggle="collapse" data-parent="#accordion3" href="#collapse_3_1"><b>Project Detail</b> </a>
											</h4>
										</div>
										<div id="collapse_3_1" class="panel-collapse collapse">
											<div class="panel-body">
												<div class="form-group">
													<label class="col-md-3 control-label">Project Name</label>
													<div class="col-md-4">
														<textarea rows="4" cols="50" class="form-control" style="resize: none;" id="txtProjectName" name="txtDescription" placeholder="Project Name"></textarea>
													</div>
												</div>
												<div class="form-group">
													<label class="col-md-3 control-label">Telephone No</label>
													<div class="col-md-4">
														<input type="text" name="txtTelephoneNo" id="txtTelephoneNo" autocomplete="off" disabled="disabled" placeholder="Mobile No" class="form-control autocomplete-input">
													</div>
												</div>
												<div class="form-group">
													<label class="col-md-3 control-label">Mobile No</label>
													<div class="col-md-4">
														<input type="text" name="txtMobileNo" id="txtMobileNo" autocomplete="off" disabled="disabled" placeholder="Mobile No" class="form-control autocomplete-input">
													</div>
												</div>
												<div class="form-group">
													<label class="col-md-3 control-label">Email</label>
													<div class="col-md-4">
														<input type="text" name="txtEmail" id="txtEmail" autocomplete="off" disabled="disabled" placeholder="Email" class="form-control autocomplete-input">
													</div>
												</div>
											</div>
										</div>
									</div>


									<div class="panel panel-default">
										<div class="panel-heading" style="background-color: #e96864;">
											<h4 class="panel-title">
												<a class="accordion-toggle accordion-toggle-styled" data-toggle="collapse" data-parent="#accordion3" href="#collapse_2_1"><b>Activities History</b>  </a>
											</h4>
										</div>
										<div id="collapse_2_1" class="panel-collapse collapse">
											<div class="panel-body">
												<div id="divPartialView">
													@*@Html.Partial("~/Views/Complaint/_PartialViewForGridAcivityHistory.cshtml")*@
												</div>
											</div>
										</div>
									</div>


									<div class="panel panel-default" style="display: none;">
										<div class="panel-heading" style="background-color: #e96864;">
											<h4 class="panel-title">
												<a class="accordion-toggle accordion-toggle-styled collapsed" data-toggle="collapse" data-parent="#accordion3" href="#collapse_3_4"><b>New Activity</b></a>
											</h4>
										</div>
										<div id="collapse_3_4" class="panel-collapse collapse">
											<div class="panel-body">
												<p>Duis autem vel eum iriure dolor in hendrerit in vulputate. Ut wisi enim ad minim veniam, quis nostrud exerci tation ullamcorper suscipit lobortis nisl ut. </p>
												<p>
													Anim pariatur cliche reprehenderit, enim eiusmod high life accusamus terry richardson ad squid. 3 wolf moon officia aute, non cupidatat skateboard dolor brunch. Food truck quinoa nesciunt laborum
															eiusmod. Brunch 3 wolf moon tempor.
												</p>
												<p>Duis autem vel eum iriure dolor in hendrerit in vulputate. Ut wisi enim ad minim veniam, quis nostrud exerci tation ullamcorper suscipit lobortis nisl ut. </p>
												<p>
													<a class="btn red" href="ui_tabs_accordions_navs.html#collapse_3_4" target="_blank">Activate this section via URL </a>
												</p>
											</div>
										</div>
									</div>

									<div id="floating-panel" style="display: none;">
										<input id="latlng" type="text">
										<input id="name" type="text">
										@*<input id="adr_address" type="text" value="">*@
										<input id="formatted_address" type="text">
									</div>
									<div id="map" style="display: none;"></div>

								</div>
							</div>


							<div class="form-group">
								<label class="col-md-3 control-label">Team <span id="counter"></span></label>
								<div class="col-md-4">
									<input type="text" class="form-control input-tags demo-default" id="input-tags" disabled="disabled" placeholder="Team Members">
									<label class="mt-checkbox mt-checkbox-outline">
										Outsourcing
									<input type="checkbox" name="chkOutsourcing" id="chkOutsourcing" />
										<span style="border: 2px solid brown !important;"></span>
									</label>
								</div>
							</div>
							<div id="divOutsourcing">
								<div class="form-group">
									<label class="col-md-3 control-label">Outsource Company</label>
									<div class="col-md-4">
										<input type="text" class="form-control input-tags demo-default" autocomplete="off" id="txtOutsourceCompany" disabled="disabled" placeholder="Outsource Company">
									</div>
								</div>
								<div class="form-group">
									<label class="col-md-3 control-label">Team <span id="counter1"></span></label>
									<div class="col-md-4">
										<input type="text" class="form-control input-tags demo-default" id="txtOutsourceCompanyTeam" disabled="disabled" placeholder="Team Members">
										<a href="~/Outsource/RegisterOutsourceTeam" target="_self">Add Outsource Team
										</a>
									</div>
								</div>
							</div>
							<div class="form-group">
								<label class="col-md-3 control-label">Checkin Time</label>
								<div class="col-md-4">
									<input type="text" class="form-control" id="txtDefaultTime" disabled="disabled" placeholder="Enter text">
								</div>
							</div>
						</div>
						<div class="form-actions">
							<div class="row">
								<div class="col-md-offset-3 col-md-9">
									<button type="submit" class="btn green">CHECKIN</button>
								</div>
							</div>
						</div>
					</form>

					<!-- END FORM-->
					<form method="post" id="form1" class="form-horizontal">
						<div class="form-body">
							<div class="form-group">
								<label class="col-md-3 control-label">Checkout Time</label>
								<div class="col-md-4">
									<input type="text" class="form-control" id="txtDefaultCheckoutTime" disabled="disabled" placeholder="Enter text">
								</div>
							</div>
						</div>
						<div class="form-actions">
							<div class="row">
								<div class="col-md-offset-3 col-md-9">
									<button type="submit" id="btnsubmit" class="btn green">CHECKOUT</button>
									@*<a href="@Html.Action("Handover")" style="display:none;"  id="btnHandover" class="btn green">HANDOVER</a>*@
								</div>
							</div>
						</div>
					</form>
					<div class="form-group"></div>
					<div id="divPartialView2">
						@Html.Partial("~/Views/Complaint/_PartialViewForComplainCheckIn.cshtml", Model)
					</div>

				</div>
			</div>
		</div>
	</div>
</div>

<script>

	function initMap() {

		var options = { enableHighAccuracy: true, timeout: 20000, maximumAge: 2000 };

		if (navigator.geolocation) {
			navigator.geolocation.getCurrentPosition(showPosition, positionError, options);
		}
	}

	function LatLng(latitude, longitude) {
		var map = new google.maps.Map(document.getElementById('map'), {
			zoom: 25,
			center: { lat: latitude, lng: longitude }
		});
		var geocoder = new google.maps.Geocoder;
		var infowindow = new google.maps.InfoWindow;
		geocodeLatLng(geocoder, map, infowindow);
	}
	function geocodeLatLng(geocoder, map, infowindow) {
		var input = document.getElementById('latlng').value;
		var latlngStr = input.split(',', 2);
		var latlng = { lat: parseFloat(latlngStr[0]), lng: parseFloat(latlngStr[1]) };
		geocoder.geocode({ 'location': latlng, 'region': 'UAE' }, function (results, status) {
			if (status === 'OK') {
				if (results[0]) {
					map.setZoom(25);
					var marker = new google.maps.Marker({
						position: results[0].geometry.location,
						map: map
					});

					var service = new google.maps.places.PlacesService(map);
					var request = {
						placeId: results[0].place_id
					};
					service.getDetails(request, function (place, status) {
						if (status == google.maps.places.PlacesServiceStatus.OK) {
							console.log(place.name);
							console.log(place.adr_address);
							console.log(place.formatted_address);
							document.getElementById('name').value = place.name;
							//document.getElementById('adr_address').value = place.adr_address;
							document.getElementById('formatted_address').value = place.formatted_address;
						}
					});
					infowindow.setContent(results[0].formatted_address);
					infowindow.open(map, marker);
				} else {
					window.alert('No results found');
				}
			} else {
				window.alert('Geocoder failed due to: ' + status);
			}
		});
	}

	function showPosition(position) {
		var coordinates = position.coords;

		var latitude = position.coords.latitude;
		var longitude = position.coords.longitude;
		document.getElementById('latlng').value = latitude + ', ' + longitude;
		LatLng(latitude, longitude);
	}

	function positionError(position) {
	}
</script>
<script async defer
	src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDRhSfZnKy-1wxL8xCX0kpRXUh1OXhcrOE&callback=initMap&&libraries=places">
</script>


<style>
	.table-responsive > .table > tbody > tr > td, .table-responsive > .table > tbody > tr > th, .table-responsive > .table > tfoot > tr > td, .table-responsive > .table > tfoot > tr > th, .table-responsive > .table > thead > tr > td, .table-responsive > .table > thead > tr > th {
		white-space: normal;
	}

	.loader {
		display: none;
	}

	.table-pager > td {
		padding-top: 70px;
	}

		.table-pager > td > a {
			background-color: #f0f0f0;
			border: 1px solid #ccc;
			border-radius: 3px;
			padding: 3px 7px;
		}

			.table-pager > td > a:hover {
				/*background-color: #f0f0f0;*/
				background-color: #4CAF90;
			}

	.btn-default.active, .btn-default:active, .btn-default:hover, .open > .btn-default.dropdown-toggle {
		color: #333;
		background-color: #ada5a5;
		border-color: #ada5a5;
	}
</style>


<script src="~/Custom_Scripts/multiple-select/selectize.js"></script>
<link href="~/Custom_Scripts/multiple-select/selectize.bootstrap3.css" rel="stylesheet" />
<script src="~/jquery.loading-overlay.js"></script>

@*<script src="~/theme/assets/global/plugins/jquery.min.js" type="text/javascript"></script>*@
<link href="~/theme/assets/global/plugins/icheck/skins/all.css" rel="stylesheet" type="text/css" />
<script src="~/theme/assets/global/plugins/icheck/icheck.min.js" type="text/javascript"></script>
@*<script src="~/theme/assets/global/scripts/app.min.js" type="text/javascript"></script>*@
@*<script src="~/theme/assets/pages/scripts/form-icheck.min.js" type="text/javascript"></script>*@
<script src="~/theme/assets/global/plugins/bootstrap-tabdrop/js/bootstrap-tabdrop.js" type="text/javascript"></script>
@*<script src="~/theme/assets/global/plugins/moment.min.js"></script>*@

<script type="text/javascript" src="~/Moments/jstz-1.0.4.min.js"></script>
<script type="text/javascript" src="~/Moments/moment.min.js"></script>
<script type="text/javascript" src="~/Moments/moment-timezone.js"></script>
<script type="text/javascript" src="~/Moments/moment-timezone-data.js"></script>


<script src="~/serverDate.js"></script>
<script>
	var counter = 0;
	var counter1 = 0;
	$(document).ready(function () {
		var checkoutFlag = @Html.Raw(Json.Encode(Model._TimesheetComGridPostDTO))
		$('#form1').hide();
		$.each(checkoutFlag, function (index, item) {
			if (item.is_checkout == false) {
				$('#form').hide();
				$('#form1').show();
				return false;
			}
		});

		ShowTime();
		$.ajax({
			type: "POST",
			url: "/Complaint/getComplainList",
			data: {},
			contentType: "application/json; charset=utf-8",
			dataType: "json",
			success: function (Result) {
				$('#txtComplainNo').removeAttr('disabled');
				$('#txtComplainNo').selectize({
					//plugins: ['remove_button'],
					persist: false,
					create: false,
					maxItems: 1,
					valueField: 'com_no',
					labelField: 'com_no',
					searchField: 'com_no',
					options: Result,
					render: {
						item: function (data, escape) {
							return '<div>' + escape(data.com_no) + '</div>';
						}
					},
					onChange: function (escape) {
						$.each(Result, function (index, values) {
							if (Result[index].com_no === escape) {

								$("#txtJobNo").val(Result[index].com_job);
								$("#txtCustomer").val(Result[index].AC_NAME);
								$("#txtComplainName").val(Result[index].com_name);
								$("#txtDescription").val(Result[index].com_narration);
								$("#txtComplainType").val(Result[index].complainttype_ac_name);
								$("#txtContactPerson").val(Result[index].com_person);
								$("#txtPhoneNo").val(Result[index].com_phone);
								$("#txtComplainDate").val(moment(Result[index].com_date).format("DD-MM-YYYY"));
								$("#txtTelephoneNo").val(Result[index].contact_Telno);
								$("#txtProjectName").val(Result[index].Job_name);
								$("#txtMobileNo").val(Result[index].contact_Mobno);
								$("#txtEmail").val(Result[index].contact_Email);

								if (Result[index].Priority != null) {
									$("#chkHigh").iCheck('check');
									$("#chkNormal").iCheck('uncheck');
								}
								else {
									$("#chkNormal").iCheck('check');
									$("#chkHigh").iCheck('uncheck');
								}
								var x = (Result[index].com_no);
								$.ajax({
									type: 'post',
									cache: false,
									url: "/Complaint/getAllActivitiesList",
									data: JSON.stringify({ 'com_no': x }),
									contentType: "application/json; charset=utf-8",
									dataType: 'text',
									success: function (Result) {

										$('#divPartialView').html(Result);
									},
									error: function (result, xhr) { }
								});

							}
						});
					}
				});
				//$('#txtJobNo').selectize({
				//    //plugins: ['remove_button'],
				//    persist: false,
				//    create: false,
				//    maxItems: 1,
				//    valueField: 'com_job',
				//    labelField: 'com_job',
				//    searchField: 'com_job',
				//    options: Result,
				//    render: {
				//        item: function (data, escape) {
				//            return '<div>' + escape(data.com_job) + '</div>';
				//        }
				//    },
				//    onChange: function (escape) {
				//        //$.each(Result, function (index, values) {
				//        //    if (Result[index].ord_no === escape) {
				//        //        $("#txtProjectName").val(Result._enq_mast[index].job_name).attr('disabled', 'disabled');
				//        //    }
				//        //});
				//    }
				//});
			}
		});

		$("#divOutsourcing").hide();
		$("#chkOutsourcing").click(function () {
			if (this.checked == true) {
				$("#divOutsourcing").show(this);
			}
			else { $("#divOutsourcing").hide(this); }
		});

		$.ajax({
			type: "POST",
			url: "/Home/GetProjectDetailList",
			data: {},
			contentType: "application/json; charset=utf-8",
			dataType: "json",
			success: function (Result) {

				$('#txtOutsourceCompany').removeAttr('disabled');
				$('#input-tags').removeAttr('disabled');

				$('#input-tags').selectize({
					plugins: ['remove_button'],
					persist: false,
					create: false,
					valueField: 'empID',
					labelField: 'Firstname',
					searchField: 'Firstname',
					options: Result._employee,
					render: {
						item: function (data, escape) {
							$("#counter").text('(' + ++counter + ')');
							if (counter == 0 || counter < 0) {
								$("#counter").text('');
							}
							return '<div>' + escape(data.Firstname) + '</div>';
						}
					},
					onDelete: function (values) {
						$("#counter").text('(' + --counter + ')');
						if (counter == 0 || counter < 0) {
							$("#counter").text('');
						}
					}

				});

				$('#txtOutsourceCompany').selectize({
					//plugins: ['remove_button'],
					persist: false,
					create: false,
					maxItems: 1,
					valueField: 'id',
					labelField: 'companyName',
					searchField: 'companyName',
					options: Result._OutSourceDetail,
					render: {
						item: function (data, escape) {
							return '<div>' + escape(data.companyName) + '</div>';
						}
					},
					onChange: function (values) {
						var id = $('#txtOutsourceCompany').val();
						$('#txtOutsourceCompanyTeam').selectize()[0].selectize.destroy();

						var selectize = $select[0].selectize;
						selectize.clear();



						$.ajax({
							type: "POST",
							url: "/Home/GetOutSourceEmployeeList",
							data: JSON.stringify({ 'outsourced_id': id }),
							contentType: "application/json; charset=utf-8",
							dataType: "json",
							success: function (Result) {
								$('#txtOutsourceCompanyTeam').removeAttr('disabled');

								$('#txtOutsourceCompanyTeam').selectize({
									plugins: ['remove_button'],
									persist: false,
									create: false,
									valueField: 'Firstname',
									labelField: 'Firstname',
									searchField: 'Firstname',
									options: Result._OutsourcedEmployees,
									render: {
										item: function (data, escape) {
											$("#counter1").text('(' + ++counter1 + ')');
											if (counter1 == 0 || counter1 < 0) {
												$("#counter1").text('');
											}

											return '<div>' + escape(data.Firstname) + '</div>';
										}
									},
									onDelete: function (values) {
										$("#counter1").text('(' + --counter1 + ')');
										if (counter1 == 0 || counter1 < 0) {
											$("#counter1").text('');
										}
									}
								});
							}
						});
					}
				});
			}
		});
	});
	function ShowTime() {
		var current_time = moment().tz('Asia/Dubai').format('h:mm A');
		$('#txtDefaultTime').val(current_time);
		$('#txtDefaultCheckoutTime').val(current_time);
		window.setTimeout("ShowTime()", 1000);//1000 miliseconds = 1 second
	}

	

	$('form').submit(function (e) {
		if ($('#txtComplainNo').val() == '') {
			alert('Please select the Complain No');
			e.preventDefault();
			return false;
		}

		$('.page-container').loader({
			image: '../loader.gif'
		});

		//location

		var location = {
			"latlng": $('#latlng').val(),
			"name": $('#name').val(),
			"formatted_address": $('#formatted_address').val()
		};

		var arrayTeam = $('#input-tags').val().split(',');
		var arrayOutsourceCompanyTeam = $('#txtOutsourceCompanyTeam').val().split(',');
		if (arrayOutsourceCompanyTeam == '') {
			arrayOutsourceCompanyTeam.length = null;
		}
		var dt = new Date();
		var time = new Date().toLocaleTimeString(navigator.language, { hour: '2-digit', minute: '2-digit' });
		var TimesheetComPostDTO = {
			"ComplainNo": $('#txtComplainNo').val(),
			"Team": arrayTeam,
			"OutsourceCompanyID": $('#txtOutsourceCompany').val(),
			"OutsourceTeam": arrayOutsourceCompanyTeam,
			"Time": time,
			"location": location
		};

		$.ajax({
			url: '@Url.Action("Complaint")',
			type: "POST",
			datatype: "text/plain",
			contentType: "application/json; charset=utf-8",
			data: JSON.stringify(TimesheetComPostDTO),
			success: function (result) {
				window.location = window.location;
				$('.page-container').loader('hide');
			},
			error: function (result, xhr) {
				window.location = window.location;
				$('.page-container').loader('hide');
			}
		});
		return false;
	});



	$('#btnsubmit').click(function (event) {
		$('.page-container').loader({
			image: '../loader.gif'
		});
		event.preventDefault();
		var CheckoutTime = $('#txtDefaultCheckoutTime').val()
		$.ajax({
			url: '@Url.Action("AllCheckOut")',
				type: "POST",
				dataType: "json",
				contentType: "application/json; charset=utf-8",
				data: JSON.stringify({ 'CheckoutTime': CheckoutTime }),
				success: function (result) {
					window.location = window.location;
					$('.page-container').loader('hide');
				},
				error: function (result) {
					window.location = window.location;
					$('.page-container').loader('hide');
				}
			});
			return false;
		});

		function confirmCheckout(emp_id) {
			var CheckoutTime = $('#txtDefaultCheckoutTime').val()

			$('.page-container').loader({
				image: '../loader.gif'
			});
			$.ajax({
				type: "POST",
				url: '@Url.Action("CheckIfUserIsAdmin")',
			data: JSON.stringify({ 'empid': emp_id }),
			contentType: "application/json; charset=utf-8",
			dataType: "json",
			success: function (result) {
				if (result.length == 1 || result.length == 0) {
					CheckOutIndividual(emp_id, CheckoutTime);
					$('.page-container').loader('hide');
				}
				else {
					alert("Please handover employees before you checkout.");
					$('.page-container').loader('hide');
				}
			},
			error: function (result) {
				window.location = window.location;
				$('.page-container').loader('hide');
			}
		});
		return false;
	}


	function CheckOutIndividual(emp_id, CheckoutTime) {
		if (confirm('Are you sure you wish to checkout?')) {
			$('.page-container').loader({
				image: '../loader.gif'
			});
			$.ajax({
				type: "POST",
				url: '@Url.Action("IndividualCheckOut")',
				data: JSON.stringify({ 'empid': emp_id, 'checkOutTime': CheckoutTime }),
				contentType: "application/json; charset=utf-8",
				dataType: "json",
				success: function (result) {
					window.location = window.location;
					$('.page-container').loader('hide');

				},
				error: function (result) {
					window.location = window.location;
					$('.page-container').loader('hide');
				}
			});
		} else {
			$('.page-container').loader('hide');
		}
	}

	$(document).ajaxStart(function () {
		$('.page-container').loader({
			image: '../loader.gif'
		});
	}).ajaxStop(function () {
		$('.page-container').loader('hide');
	});


</script>



