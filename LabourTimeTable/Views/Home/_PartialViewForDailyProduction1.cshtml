@model LabourTimeTable.Models.SystemTaskDTO

@{
    //ViewBag.Title = "Order List"; data-title="Are you sure?"
    //WebGrid grid = new WebGrid(source: Model, canSort: false);
    Layout = null;
}
<link href="~/theme/assets/global/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet" />

<link href="~/theme/assets/global/plugins/datatables/datatables.min.css" rel="stylesheet" type="text/css" />
<link href="~/theme/assets/global/plugins/datatables/plugins/bootstrap/datatables.bootstrap.css" rel="stylesheet" type="text/css" />



@if (ViewBag.Error != null)
{
    <div class="alert alert-danger display-hide" style="display: block;">
        <button class="close" data-close="alert"></button>
        <span>@ViewBag.Error </span>
    </div>
}


<a href="javascript:;" class="menu-toggler responsive-toggler" data-toggle="collapse" data-target=".navbar-collapse">
    <span></span>
</a>

<div class="portlet-title">
    @{
        if (Model._JobDailyProductionCBList != null && Model._JobDailyProductionITAList != null && Model._JobDailyProductionTCList != null)
        { 
        <div class="caption">
            System Tasks
        </div>
        }
    }
</div>
<div class="portlet-body">
    <input type="text" class="form-control" style="display: none;" id="txttskid" />
    <input type="text" class="form-control" style="display: none;" id="txtQtyItem" />
    <input type="text" class="form-control" style="display: none;" id="txtQtyDone" />
    <div class="panel-group accordion" id="accordion3">
        @{
            if (Model._JobDailyProductionCBList != null)
            {
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h4 class="panel-title" style="background-color: #e96864;">
                        <a class="accordion-toggle accordion-toggle-styled" data-toggle="collapse" data-parent="#accordion3" href="#collapse_3_1">Cable Pulling</a>
                    </h4>
                </div>
                <div id="collapse_3_1" class="panel-collapse in">
                    <div class="panel-body" style="overflow-y: auto;">
                        <div class="portlet-body">
                            <div class="table-scrollable">
                                <table id="xtable" class="table table-condensed table-hover">
                                    <thead>
                                        <tr>
                                            <th>Task Name </th>
                                            <th>Qty Item </th>
                                            <th>Qty Done</th>
                                            <th>Fixed</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @{
                                            foreach (var item in Model._JobDailyProductionCBList)
                                            {
                                                <tr>
                                                    <td style="display: none;" data-id="@item.Id"></td>
                                                    @if (item.qty_item > 0)
                                                    {
                                                        <td><a data-toggle="popover" data-id="@item.Id" data-placement="top">@item.taskname</a></td>
                                                    }
                                                    else
                                                    {
                                                        <td>@item.taskname</td>
                                                    }
                                                    <td data-value="@string.Format("{0:##.##}", @item.qty_item)">@string.Format("{0:##.##}", @item.qty_item) </td>
                                                    <td data-value="@string.Format("{0:##.##}", @item.QtyDone)">@string.Format("{0:##.##}", @item.QtyDone) </td>
                                                    <td>@string.Format("{0:##.##}", @item.Qty) </td>
                                                </tr>
                                            }
                                        }
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
                 
            }
        }

        @{
            if (Model._JobDailyProductionITAList != null)
            {
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h4 class="panel-title" style="background-color: #e96864;">
                        <a class="accordion-toggle accordion-toggle-styled collapsed" data-toggle="collapse" data-parent="#accordion3" href="#collapse_3_2">Installation & Termination Activities</a>
                    </h4>
                </div>
                <div id="collapse_3_2" class="panel-collapse collapse">
                    <div class="panel-body" style="overflow-y: auto;">
                        <div class="portlet-body">
                            <div class="table-scrollable">
                                <table id="xtable1" class="table table-condensed table-hover">
                                    <thead>
                                        <tr>
                                            <th>Task Name </th>
                                            <th>Qty Item </th>
                                            <th>Qty Done</th>
                                            <th>Fixed</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @{
                foreach (var item in Model._JobDailyProductionITAList)
                {
                                            <tr>
                                                <td style="display: none;" data-id="@item.Id"></td>
                                                @if (item.qty_item > 0)
                                                {
                                                    <td><a data-toggle="popover" data-id="@item.Id" data-placement="top">@item.taskname</a></td>
                                                }
                                                else
                                                {
                                                    <td>@item.taskname</td>
                                                }
                                                <td data-value="@string.Format("{0:##.##}", @item.qty_item)">@string.Format("{0:##.##}", @item.qty_item) </td>
                                                <td data-value="@string.Format("{0:##.##}", @item.QtyDone)">@string.Format("{0:##.##}", @item.QtyDone) </td>
                                                <td>@string.Format("{0:##.##}", @item.Qty) </td>
                                            </tr>
                                                
                }
                                        }

                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            }
        }

        @{
            if (Model._JobDailyProductionTCList != null)
            {
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h4 class="panel-title" style="background-color: #e96864;">
                        <a class="accordion-toggle accordion-toggle-styled collapsed" data-toggle="collapse" data-parent="#accordion3" href="#collapse_3_3">Testing & Commissioning</a>
                    </h4>
                </div>
                <div id="collapse_3_3" class="panel-collapse collapse">
                    <div class="panel-body" style="overflow-y: auto;">
                        <div class="portlet-body">
                            <div class="table-scrollable">
                                <table id="xtable2" class="table table-condensed table-hover">
                                    <thead>
                                        <tr>
                                            <th>Task Name </th>
                                            <th>Qty Item </th>
                                            <th>Qty Done</th>
                                            <th>Fixed</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @{
                foreach (var item in Model._JobDailyProductionTCList)
                {
                                            <tr>
                                                <td style="display: none;" data-id="@item.Id"></td>
                                                @if (item.qty_item > 0)
                                                {
                                                    <td><a data-toggle="popover" data-id="@item.Id" data-placement="top">@item.taskname</a></td>
                                                }
                                                else
                                                {
                                                    <td>@item.taskname</td>
                                                }
                                                <td data-value="@string.Format("{0:##.##}", @item.qty_item)">@string.Format("{0:##.##}", @item.qty_item) </td>
                                                <td data-value="@string.Format("{0:##.##}", @item.QtyDone)">@string.Format("{0:##.##}", @item.QtyDone) </td>
                                                <td>@string.Format("{0:##.##}", @item.Qty) </td>
                                            </tr>
                }
                                        }

                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            }
        }

    </div>


</div>



<div id="popover-content" class="hide">
    <form class="form-inline" role="form">
        <div class="form-group" style="padding: 5px;">
            <input type="number" class="form-control" autocomplete="off" required id="txtQuantity" placeholder="Quantity" />
            <br />
            <input type="text" class="form-control" autocomplete="off" required id="txtFloorNo" placeholder="Floor No" />
        </div>
        <div class="btn-group">
            <button type="button" id="btnPartialSave" class="btn btn-sm btn-success">Save</button>
            <button type="button" id="btnPartialCancel" class="btn btn-sm btn-danger">Cancel</button>
        </div>
    </form>
</div>



<script src="~/theme/assets/global/plugins/bootstrap-confirmation/bootstrap-confirmation.min.js" type="text/javascript"></script>
<script src="~/theme/assets/global/scripts/app.min.js" type="text/javascript"></script>
<style>
    .popover {
        left: 50px !important;
    }

    input[type=number]::-webkit-inner-spin-button,
    input[type=number]::-webkit-outer-spin-button {
        -webkit-appearance: none;
        margin: 0;
    }
</style>

<style>
    .table-responsive table {
        border-collapse: collapse;
        border: 1px solid #ccc;
    }

        .table-responsive table th {
            background-color: #B8DBFD;
            border: 1px solid #ccc;
        }

            .table-responsive table th td {
                border: 1px solid #ccc;
            }
</style>

<script>
    $('[data-toggle="popover"]').popover({
        container: 'body',
        html: true,
        animation: true,
        content: function (e) {
            return $('#popover-content').html();
        }
    });

    $('body').on('click', function (e) {
        $('[data-toggle="popover"]').each(function () {
            if (!$(this).is(e.target) && $(this).has(e.target).length === 0 && $('.popover').has(e.target).length === 0) {
                $(this).popover('hide');
            }
        });
    });

    $(function () {
        $('#xtable tbody tr').hover(function () {
            $(this).toggleClass('clickable');
        }).on('click', function () {
            $("#txttskid").val($(this).children().attr('data-id'));
            $("#txtQtyItem").val($(this).children().next().next().attr('data-value'));
            $("#txtQtyDone").val($(this).children().next().next().next().attr('data-value'));
        });
    });

    $(function () {
        $('#xtable1 tbody tr').hover(function () {
            $(this).toggleClass('clickable');
        }).on('click', function () {
            $("#txttskid").val($(this).children().attr('data-id'));
            $("#txtQtyItem").val($(this).children().next().next().attr('data-value'));
            $("#txtQtyDone").val($(this).children().next().next().next().attr('data-value'));
        });
    });

    $(function () {
        $('#xtable2 tbody tr').hover(function () {
            $(this).toggleClass('clickable');
        }).on('click', function () {
            $("#txttskid").val($(this).children().attr('data-id'));
            $("#txtQtyItem").val($(this).children().next().next().attr('data-value'));
            $("#txtQtyDone").val($(this).children().next().next().next().attr('data-value'));
        });
    });


</script>
